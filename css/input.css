@tailwind base;
@tailwind components;
@tailwind utilities;

/* ==========================================================================
   Neubrutalist Design System - CSS Custom Properties
   Ported from React SPA src/index.css for design parity
   ========================================================================== */

:root {
  /* Shadow variants - brutal aesthetic with hard offsets */
  --shadow-brutal-sm: 3px 3px 0 #000;
  --shadow-brutal: 4px 4px 0 #000;
  --shadow-brutal-md: 6px 6px 0 #000;
  --shadow-brutal-lg: 8px 8px 0 #000;

  /* Transition timing - consistent animation feel */
  --transition-default: all 0.15s ease;
  --transition-transform: transform 0.15s ease;
}

/* ==========================================================================
   Base Layer - Global Resets and Typography
   ========================================================================== */

@layer base {
  /* Remove all border-radius - Neubrutalist aesthetic requires sharp corners */
  * {
    border-radius: 0 !important;
  }

  body {
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
    background-color: #FFFBEB;
    color: #000000;
    line-height: 1.6;
  }

  h1, h2, h3, h4, h5, h6 {
    font-weight: 900;
    line-height: 1.2;
  }
}

/* ==========================================================================
   Utilities Layer - Neubrutalist Component Classes
   ========================================================================== */

@layer utilities {
  /* Brutal box variants - cards, containers, interactive elements */
  .brutal-box {
    @apply bg-white border-4 border-black;
    box-shadow: var(--shadow-brutal-md);
  }

  .brutal-box-sm {
    @apply bg-white border-2 border-black;
    box-shadow: var(--shadow-brutal-sm);
  }

  .brutal-box-lg {
    @apply bg-white border-4 border-black;
    box-shadow: var(--shadow-brutal-lg);
  }

  /* Logo button - matches React Header.tsx */
  .logo-btn {
    box-shadow: var(--shadow-brutal);
  }

  .logo-btn:active {
    box-shadow: 2px 2px 0 #000;
  }

  /* Navigation button styles - box-shadow only (other styles inline for React parity) */
  .nav-btn {
    box-shadow: var(--shadow-brutal-sm);
  }

  .nav-btn:active {
    box-shadow: 2px 2px 0 #000;
  }

  /* Mobile nav button - full width with Neubrutalist styling */
  .nav-btn-mobile {
    @apply block w-full text-left px-4 py-2 text-sm font-bold uppercase;
    @apply border-2 border-black bg-white text-black;
    @apply transition-all duration-150;
    box-shadow: var(--shadow-brutal-sm);
  }

  .nav-btn-mobile:hover {
    @apply bg-lime-300;
  }

  .nav-btn-mobile:active {
    @apply translate-y-1;
    box-shadow: 2px 2px 0 #000;
  }

  .nav-btn-mobile.is-active {
    @apply bg-yellow-400 text-black;
  }

  /* Hover lift interactions - subtle elevation on hover */
  .hover-lift {
    transition: var(--transition-transform);
  }
  .hover-lift:hover {
    @apply -translate-y-1;
  }

  .hover-lift-lg {
    transition: var(--transition-transform);
  }
  .hover-lift-lg:hover {
    @apply -translate-y-2;
  }
}

/* ==========================================================================
   Focus States - Accessibility (Architecture Requirement)
   4px black outline per Architecture spec
   ========================================================================== */

:focus-visible {
  outline: 4px solid black;
  outline-offset: 2px;
}

/* ==========================================================================
   Skip Link Styles - Must be visible on focus
   ========================================================================== */

.skip-link {
  @apply sr-only;
}

.skip-link:focus-visible {
  @apply not-sr-only fixed top-4 left-4 bg-black text-white px-4 py-2 z-50 border-4 border-lime-400;
  box-shadow: var(--shadow-brutal);
}

/* ==========================================================================
   Reduced Motion - Critical for Accessibility
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
  }

  .hover-lift:hover,
  .hover-lift-lg:hover {
    transform: none !important;
  }
}

/* ==========================================================================
   Blog Post Prose Styling - Story 2.2
   Readable typography for Markdown content with Neubrutalist accents
   ========================================================================== */

.prose h2 {
  @apply text-2xl font-black mt-8 mb-4;
}

.prose h3 {
  @apply text-xl font-bold mt-6 mb-3;
}

.prose p {
  @apply text-lg leading-relaxed text-neutral-700 mb-6;
}

.prose ul, .prose ol {
  @apply mb-6 ml-6;
}

.prose ul {
  @apply list-disc;
}

.prose ol {
  @apply list-decimal;
}

.prose li {
  @apply text-lg leading-relaxed text-neutral-700 mb-2;
}

.prose pre {
  @apply bg-neutral-900 p-4 mb-6 overflow-x-auto border-4 border-black;
  color: #f5f5f5; /* neutral-100 - default text, token classes override */
}

.prose code:not(pre code) {
  @apply bg-neutral-100 px-1 py-0.5 text-sm font-mono;
}

.prose blockquote {
  @apply border-l-4 border-black pl-4 py-2 bg-yellow-50 mb-6 italic;
}

.prose a {
  @apply text-pink-600 hover:underline font-bold;
}

.prose strong {
  @apply font-bold;
}

.prose em {
  @apply italic;
}

/* ==========================================================================
   Prism Syntax Highlighting - Token Colors (Story 2.3)
   Neubrutalist color palette for code readability on dark background
   ========================================================================== */

/* Comments - muted gray for de-emphasis */
.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #6b7280; /* neutral-500 */
}

/* Punctuation - subtle but visible */
.token.punctuation {
  color: #e5e7eb; /* neutral-200 */
}

/* Values - numbers, booleans, constants */
.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #f87171; /* red-400 - bright for dark bg */
}

/* Strings - green for readability */
.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #4ade80; /* green-400 */
}

/* Operators and URLs */
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #fbbf24; /* amber-400 */
}

/* Keywords - purple for distinction */
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #c084fc; /* purple-400 */
}

/* Functions and class names - blue */
.token.function,
.token.class-name {
  color: #60a5fa; /* blue-400 */
}

/* Regex, variables, important */
.token.regex,
.token.important,
.token.variable {
  color: #fb923c; /* orange-400 */
}

/* Text emphasis */
.token.important,
.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}

/* ==========================================================================
   Code Block Copy Functionality - Story 2.4
   Progressive enhancement: code remains visible without JS
   ========================================================================== */

.code-block-wrapper {
  @apply mb-6;
}

.code-block-header {
  @apply flex items-center justify-between bg-black text-white px-4 py-2 border-4 border-black;
}

.code-block-language {
  @apply text-xs font-bold uppercase;
}

.code-block-copy {
  @apply px-2 py-1 bg-lime-400 text-black border-2 border-black text-xs font-bold uppercase;
  @apply hover:bg-yellow-400 transition-colors;
}

.code-block-copy.is-copied {
  @apply bg-green-400;
}

/* Adjust pre element when inside wrapper (remove top border for seamless look) */
.code-block-wrapper pre {
  @apply border-t-0 mt-0;
}

/* ==========================================================================
   Diagram Viewer - Fullscreen Modal with Zoom
   Click on any diagram to view fullscreen with zoom controls
   ========================================================================== */

/* Clickable diagram wrapper */
[data-diagram-viewer] {
  cursor: pointer;
  transition: transform 0.15s ease;
}

[data-diagram-viewer]:hover {
  transform: translateY(-2px);
}

[data-diagram-viewer]:hover .diagram-expand-hint {
  opacity: 1;
}

.diagram-expand-hint {
  @apply absolute top-2 right-2 px-2 py-1 bg-black text-white text-xs font-bold uppercase;
  opacity: 0;
  transition: opacity 0.15s ease;
}

/* Modal backdrop and container */
.diagram-modal {
  @apply fixed inset-0 z-50 flex items-center justify-center;
}

.diagram-modal.hidden {
  display: none;
}

.diagram-modal-backdrop {
  @apply absolute inset-0 bg-black/80;
}

.diagram-modal-content {
  @apply relative z-10 w-full max-w-5xl mx-4 bg-white border-4 border-black flex flex-col;
  max-height: 90vh;
  box-shadow: 12px 12px 0 #000;
}

/* Modal header */
.diagram-modal-header {
  @apply flex items-center justify-between px-4 py-3 border-b-4 border-black bg-yellow-400;
}

.diagram-modal-title {
  @apply font-black uppercase;
}

.diagram-modal-controls {
  @apply flex items-center gap-2;
}

.diagram-zoom-btn {
  @apply p-2 bg-white border-2 border-black hover:bg-lime-300 transition-colors;
}

.diagram-zoom-btn:active {
  transform: translateY(1px);
}

.diagram-zoom-level {
  @apply px-2 py-1 bg-white border-2 border-black font-bold text-sm min-w-[60px] text-center;
}

.diagram-close-btn {
  @apply p-2 bg-red-500 text-white border-2 border-black hover:bg-red-600 ml-2 transition-colors;
}

/* Modal body - scrollable container */
.diagram-modal-body {
  @apply flex-1 overflow-hidden;
}

.diagram-container {
  @apply w-full h-full overflow-auto p-8 bg-neutral-100;
  cursor: grab;
  min-height: 400px;
  max-height: calc(90vh - 140px);
}

.diagram-container:active {
  cursor: grabbing;
}

.diagram-image {
  @apply max-w-none mx-auto block;
  transform-origin: center center;
  transition: transform 0.15s ease;
}

/* Modal footer */
.diagram-modal-footer {
  @apply px-4 py-2 border-t-4 border-black bg-neutral-200;
}

.diagram-hint {
  @apply text-xs text-neutral-600;
}

/* Responsive adjustments */
@media (max-width: 640px) {
  .diagram-modal-content {
    @apply mx-2;
    max-height: 95vh;
  }

  .diagram-modal-header {
    @apply flex-wrap gap-2;
  }

  .diagram-modal-title {
    @apply w-full text-sm;
  }

  .diagram-zoom-level {
    @apply text-xs min-w-[50px];
  }

  .diagram-container {
    @apply p-4;
  }
}
